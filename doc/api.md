# API 文档
以下**全部** API 都只接收 POST 方法，都只需要有 `username`（表示你的NetID）和 `password` 两个字段。请求体注意使用 `x-www-form-urlencoded` 格式而不是 `json` 格式。

所有请求的响应中，状态码用 HTTP 的状态码来表示，错误信息和成功提示语直接写在响应体里。

## /api/submit
将会把该用户放到申请队列中，过一会轮到该用户时，就会尝试为该用户提交一次健康申请表，如果成功，则会在微信上收到成功提示。一般而言不会申报失败，如果没有收到提示，可能的原因如下：

- 密码错误，请仔细检查
- jksb系统延迟，再过一小会就能收到
- jksb系统下线，每天过了0点之后系统就会下线，清晨才会重新上线

基本上可以不用怀疑验证码 OCR 的问题，识别的失败率较低，后台还有失败重复尝试的逻辑，若干次全部都失败的概率非常低。

| 状态码 | 含义 |
| - | - |
| 200 | 申请成功加入申请队列中，过一会可以查看微信是否有成功提示 |
| 405 | 请求非 POST 方法 |
| 400 | 请求体中没有 `username` 或 `password` 字段 |
| 429 | 这名用户已经在队列中，不要重复申请 |
| 503 | 申请队列已满，可以过一会再尝试 |

## /api/adduser
将会**先验证**提供的账户和密码是否匹配（通过登录一遍 cas 系统看是否成功），如果成功，将会把账户名和密码明文存储进数据库中，未来每天早晨都会自动替这个用户进行健康申报。

| 状态码 | 含义 |
| - | - |
| 200 | 成功将用户添加到后台数据库中 |
| 405 | 请求非 POST 方法 |
| 400 | 请求体中没有 `username` 或 `password` 字段 |
| 406 | 这名用户已经在数据库中，不可重复添加。如果要修改密码，请先删除再重新添加；还有可能是密码不正确 |

## /api/deleteuser
将会与数据库中的用户信息做对比，如果密码匹配，则会删除这名用户（真的会删除，而不是打懒标记），未来将不会再每天自动申报。

| 状态码 | 含义 |
| - | - |
| 200 | 成功将用户从后台数据库中删除 |
| 405 | 请求非 POST 方法 |
| 400 | 请求体中没有 `username` 或 `password` 字段 |
| 406 | 用户本来就不在数据库中，或者也有可能是密码不正确 |
